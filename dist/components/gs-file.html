<link rel="import" href="gs-custom-event-target.html">
<dom-module id="gs-file">
  <template>
    <style>
      

      /*# sourceMappingURL=style.css.map */

    </style>


  </template>
  <script>
    var GSFILE;

    GSFILE = (function() {
      var constructor;
      constructor = function(name, localStorageKey) {
        var _content, _name, _openers;
        _content = "";
        _name = "";
        _openers = [];
        CustomEventTarget.apply(this);
        _name = name;
        this._storage = GsFileSystem(localStorageKey);
        this.save = function(content, host) {
          _content = content;
          this._storage.storageFile(this);
          return this._fire("change", host);
        };
        this._fire = function(eventName, host) {
          var evnt;
          evnt = document.createEvent('CustomEvent');
          evnt.initEvent(eventName, true, true);
          evnt.host = host;
          return this.dispatchEvent(evnt);
        };
        this.open = function(host) {
          return _openers.push(host);
        };
        this.close = function(host) {
          var openerIndex;
          openerIndex = _openers.indexOf(host);
          if (openerIndex !== -1) {
            _openers.splice(openerIndex, 1);
            if (_openers.length === 0) {
              return this._fire('closefile');
            }
          }
        };
        this.remove = function() {
          this._fire("fileremove");
          return this.actions = {};
        };
        this.getName = function() {
          return _name;
        };
        this.getContent = function() {
          return _content;
        };
        this.setContent = function(string) {
          return _content = string;
        };
        this.update = function(content, host) {
          _content = content;
          return this._fire("change", host);
        };
        this.getData = function() {
          return {
            name: _name,
            content: _content
          };
        };
        return this;
      };
      return constructor;
    })();

  </script>
</dom-module>