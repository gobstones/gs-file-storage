<link rel="import" href="gs-file-storage.html">
<link rel="import" href="gs-submit-file.html">
<link rel="import" href="gs-file.html">
<link rel="import" href="../../../gs-file-explorer/dist/components/gs-file-explorer.html">
<dom-module id="gs-file-storage-demo">
  <template>
    <style>
      #demo-header {
        margin: 0 auto;
        background-color: #E70126;
        display: table;
        font-size: 4vh;
        border-radius: 5px;
        width: 40vw;
        text-align: center;
        margin-top: 5vh;
        height: 10vh;
      }

      #submit {
        display: block;
        margin: 6vw;
        margin-top: 4vh;
      }

      #column-1, #column-2 {
        float: left;
        width: 33vw;
      }

      #column-3 {
        float: left;
        width: 32vw;
      }

      #disabledText {
        margin: 0 auto;
        display: block;
        width: 20.4vw;
        height: 25vh;
        box-sizing: border-box;
        box-shadow: 2px 2px 5px 1px rgba(0, 0, 0, 0.2);
        padding-bottom: 2vh;
        border-radius: 3px;
        background-color: white;
        padding-top: 2vh;
        font-size: 3vh;
      }

      .demoToolTip {
        color: white;
        box-sizing: border-box;
        background: #d30123;
        border-radius: 3px 3px 0 0;
        box-shadow: 0 2px 5px 1px rgba(0, 0, 0, 0.2);
        margin: 0 auto;
        display: block;
        padding: 20px;
        margin-top: 4vh;
        height: 25vh;
        width: 100%;
        float: left;
        font-size: 2.8vh;
        font-weight: bold;
      }

      #disabledLabel {
        color: white;
        box-sizing: border-box;
        background: #d30123;
        border-radius: 3px 3px 0 0;
        box-shadow: 0 2px 5px 1px rgba(0, 0, 0, 0.2);
        margin: 0 auto;
        display: block;
        margin-top: 4vh;
        padding: 20px;
        height: 12vh;
        width: 20.5vw;
        font-size: 2.5vh;
        line-height: 150%;
      }

      /*# sourceMappingURL=style.css.map */

    </style>

    <p id="demo-header">An example of <br> <code>&lt;gs-file-storage&gt;</code>:</p>

      <div id="column-1">
        <h1 id="disabledLabel"> File change event listener. </h1>
        <textarea disabled id="disabledText"></textarea>
            
      </div>

      <div id="column-2">
        <gs-submit-file
          label="File name and content edit."
          name-field={{fileDemo.data.name}} 
          text-field={{fileDemo.data.content}} 
          button-name="Save" 
          id="submit">
        </gs-submit-file>

      </div >

      <div id="column-3" >
        <div class="demoToolTip" >
          <li>Change file content and see how the left textBox
          show the changes.
          </li>
          <li>
          Also refresh page and see last file content steel there.
          </li>
        <div>
      </div>

      <div id="column-1">

        <gs-file-explorer files="fileses"> 

        </gs-file-explorer>
        
      </div>
  </template>
  <script>
    Polymer({
      is: 'gs-file-storage-demo',
      listeners: {
        'openFile': 'openFile',
        'submitFile': 'saveFile'
      },
      properties: {
        fileContent: {
          type: String
        },
        fileses: {
          type: [],
          value: []
        }
      },
      ready: function() {
        window.localStorage.removeItem('gsFiles');
        this.storage = GsFileStorage();
        this.disabledText = this.$.disabledText;
        this.fileses = [
          {
            name: "sarasa",
            content: ""
          }
        ];
        this.makeFilesForFileExplorer(this.storage.getAllFilesName());
        this.storage.addEventListener('listchange', (function(_this) {
          return function(event) {
            return _this.makeFilesForFileExplorer(_this.storage.getAllFilesName());
          };
        })(this));
        this.fileDemo = this.storage.getFile("index.html");
        return this.fileDemo.addEventListener('change', (function(_this) {
          return function(event) {
            var file;
            file = event.target;
            return _this.refreshTextContent(file.getContent());
          };
        })(this));
      },
      saveFile: function(polymerEvent) {
        var eventFile;
        eventFile = polymerEvent.detail.file;
        this.fileDemo.setContent(eventFile.content);
        return this.fileDemo.saveIt();
      },
      refreshTextContent: function(text) {
        return this.disabledText.value = text;
      },
      makeFilesForFileExplorer: function(filesNamesList) {
        var fName, filesNames, _i, _len, _results;
        filesNames = filesNamesList;
        this.files = [];
        _results = [];
        for (_i = 0, _len = filesNames.length; _i < _len; _i++) {
          fName = filesNames[_i];
          _results.push(this.files.push({
            name: fName,
            content: ""
          }));
        }
        return _results;
      }
    });

  </script>
</dom-module>